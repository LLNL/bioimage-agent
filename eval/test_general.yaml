providers:
  - id: python:general_mcp_client.py
    config:
      cache: false
      provider: litellm
      model: gpt-4o
      baseUrl: https://livai-api.llnl.gov/v1
      verifySSL: false
      useProxy: false
           
      mcp:
        enabled: true
        server:
          command: "C:/Users/miao1/AppData/Local/anaconda3/envs/mcp/python.exe"
          args: ["-u", "D:/Development/napari-mcp/src/napari_mcp/napari_mcp_server.py"]
          cwd: "D:/Development/napari-mcp/eval"
          name: napari-server
          env:
            PORT: "3000"        
        temperature: 0
        # max_tokens: 4096
        executeTools: true

prompts:
  - |
    {{question}}

# Configure default test settings for model-graded assertions
defaultTest:
  options:
    # Override the default provider for model-graded assertions
    provider:
      id: litellm:gpt-4o
      config:
        apiBaseUrl: https://livai-api.llnl.gov/v1
        # For OpenAI-compatible endpoints served by LiteLLM
        openaiCompatible: true
        verifySSL: false
        useProxy: false

tests:
  
  # Test 1: Load the SNAP_IgM_BCR_Cell_1_ch0_t14.tif file into Napari
  - vars:
      question: |
        Load the "D:/Development/napari-mcp/eval/eval_examples/SNAP_IgM_BCR_Cell_1_ch0_t14.tif" file in Napari. 
        Take a screenshot of the result.
    assert:
      - type: contains-all
        value: 
          - "SNAP_IgM_BCR_Cell_1_ch0_t14"
      - type: llm-rubric
        value: |
          1. Successfully loaded the SNAP_IgM_BCR_Cell_1_ch0_t14.tif file
          2. Screenshot shows the object in the viewport
    options:
      cache: false
      runSerially: true

  # Test 2: Check the layers 
  - vars:
      question: |
        Check if the SNAP_IgM_BCR_Cell_1_ch0_t14 layer exists in Napari
    assert:
      - type: contains-all
        value: 
          - "SNAP_IgM_BCR_Cell_1_ch0_t14"
      - type: llm-rubric
        value: |
          1. Layer shows up in the layer list
    options:
      cache: false
      runSerially: true
      
evaluateOptions:
  cache: false  
  maxConcurrency: 1    